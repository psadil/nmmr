<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>orthogonal-bayes • nmmr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="orthogonal-bayes">
<meta property="og:description" content="nmmr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nmmr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/orthogonal-bayes.html">orthogonal-bayes</a>
    </li>
    <li>
      <a href="../articles/orthogonal.html">orthogonal</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/psadil/nmmr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="orthogonal-bayes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>orthogonal-bayes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/psadil/nmmr/blob/master/vignettes/orthogonal-bayes.Rmd"><code>vignettes/orthogonal-bayes.Rmd</code></a></small>
      <div class="hidden name"><code>orthogonal-bayes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://psadil.github.io/nmmr/">nmmr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org">forcats</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In a <a href="https://psadil.github.io/nmmr/articles/orthogonal.html">previous vignette</a>, we saw that neuromodulation was indexed with a scatterplot of voxel activity at high- versus low-contrast. This provided a quick way to differentiate between an additive offset and multiplicative gain. However, that method required an <em>ad hoc</em> preprocessing step, excluding poorly tuned voxels, to produce reasonable estimates of slopes.</p>
</div>
<div id="hierarchical-bayesian-deming-regression" class="section level1">
<h1 class="hasAnchor">
<a href="#hierarchical-bayesian-deming-regression" class="anchor"></a>Hierarchical Bayesian Deming Regression</h1>
<div id="the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-model" class="anchor"></a>The Model</h2>
<p>The model is very similar to the model underlying orthogonal regression, but for two important changes. First, the model is hierarchical. That is, whereas we previously ran a separate orthogonal regression on each voxel, we now estimate each of the separate slope, intercept, and noise terms in a single regression model<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Second, we relax the assumption that the variance in both observed variables (e.g., voxel activity at high and low contrast) is equal<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<p>The paper has full details of the model, but a schematic <a href="https://en.wikipedia.org/wiki/Plate_notation">plate diagram</a> is is reproduced here.</p>
</div>
<div id="stan-code" class="section level2">
<h2 class="hasAnchor">
<a href="#stan-code" class="anchor"></a>Stan Code</h2>
<p>The hierarchical Deming regression model is bundled with <code>nmmr</code>. As before, the data need to be in a wider format. Additionally, the tuning variable (e.g., <code>orientation</code>) should be converted into a <code>factor</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub02_wide</span> <span class="op">&lt;-</span> <span class="va">sub02</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">contrast</span>, values_from <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">orientation</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For the purposes of this vignette, we reduce the dataset down to just 100 voxels. This is only to speed up the estimation process.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">small</span> <span class="op">&lt;-</span> <span class="va">sub02_wide</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">orientation</span>, <span class="va">run</span>, <span class="va">ses</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>voxel <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_drop.html">fct_drop</a></span><span class="op">(</span><span class="va">voxel</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p>The model can be implemented by initializing an object provided by the <code>nmmr</code> package of class <code>Deming</code>. As with orthogonal regression, the <code>$new()</code> method takes a dataset and the names of the columns with the two dependent variables. Additionally, the class needs to know which column containing the tuning variable (e.g., the orientation associated with each observation), and the column indexing voxel (e.g., voxel).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Deming.html">Deming</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">small</span>, <span class="va">low</span>, <span class="va">high</span>, tuning_var <span class="op">=</span> <span class="va">orientation</span>, voxel_var <span class="op">=</span> <span class="va">voxel</span><span class="op">)</span></code></pre></div>
<p>The newly created object, <code>m</code>, is an <a href="https://r6.r-lib.org/"><code>R6</code></a> object of class <code>Deming</code>. It can be thought of as a wrapper around a <code><a href="https://mc-stan.org/cmdstanr/reference/CmdStanModel.html">cmdstanr::CmdStanModel</a></code> class, but one which does a bit of extra prep work to clean up the data and prepare it for sampling. The underlying Stan model can be accessed with the <code>$print()</code> method of the <code>cmdstanmodel</code> field.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span><span class="op">$</span><span class="va">cmdstanmodel</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Note that, in the model, the names of the parameters were chosen to match the names in the schematic, above. For example, the parameter <code>g</code> is the voxel-specific slope. The hierarchy on the slope assumes that each individual voxel’s slope comes from a population distribution, which in this case is normal with mean <code>g_mu</code> (written in the diagram <span class="math inline">\(\mu^g\)</span>) and standard deviation <code>g_sigma</code> (written in the diagram as <span class="math inline">\(\sigma^g\)</span>).</p>
<p>The object contains a method called <code>$sample()</code>, which accepts all of the arguments as does the <code>$sample()</code> method of <code><a href="https://mc-stan.org/cmdstanr/reference/CmdStanModel.html">cmdstanr::CmdStanModel</a></code>. Here, we run three chains in parallel, set the random number generator seed, and increase adapt delta to 0.9.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span>
  chains <span class="op">=</span> <span class="fl">2</span>, 
  parallel_chains <span class="op">=</span> <span class="fl">2</span>, 
  seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>The initial messages “The current Metropolis proposal is about to be rejected […]” can safely be ignored. However, if you see warnings about either divergences or maximum treedepth, be wary. For a brief introduction to these warnings, <a href="https://mc-stan.org/misc/warnings.html">see here</a>. You can try setting adapt_delta to a higher number, but if you reach a value like 0.99 and still encounter divergences, then it is likely that there is a deeper issue, a conflict between the model and your data.</p>
<p>Such conflicts are beyond the scope of this vignette, and the <code>nmmr</code> package. If increasing adapt delta does not eliminate the sampling warnings, feel free to file an issue on the <a href="https://github.com/psadil/nmmr/issues">github repository</a>. It may be possible to tailor the model to your dataset.</p>
</div>
<div id="analyzing-results" class="section level2">
<h2 class="hasAnchor">
<a href="#analyzing-results" class="anchor"></a>Analyzing Results</h2>
<p>The <code>sample</code> method returns a <a href="https://mc-stan.org/cmdstanr/reference/CmdStanMCMC.html"><code>cmdstanr::CmdStanMCMC</code></a> object. For example, we can look at a quick summary of the population-level parameters for the slope (<code>g_mu</code> and <code>g_sigma</code>), the intercept (<code>a_mu</code> and <code>a_sigma</code>), the noise at low contrast (<code>x_sigma_mu</code> and <code>x_sigma_sigma</code>), and the noise at high contrast (<code>y_sigma_mu</code> and <code>y_sigma_sigma</code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g_mu"</span>, <span class="st">"g_sigma"</span>,
              <span class="st">"a_mu"</span>, <span class="st">"a_sigma"</span>,
              <span class="st">"x_sigma_mu"</span>, <span class="st">"x_sigma_sigma"</span>,
              <span class="st">"y_sigma_mu"</span>, <span class="st">"y_sigma_sigma"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Additionally, we can make use of the many other packages that compose the Stan ecosystem. For example, <a href="https://mc-stan.org/bayesplot/"><code>bayesplot</code></a> has many resources for plotting posterior distributions. The following shows a pairs plot, useful for seeing whether parameters in the posterior tradeoff.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu">mcmc_pairs</span><span class="op">(</span>
  <span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g_mu"</span>, <span class="st">"g_sigma"</span>,
             <span class="st">"x_sigma_mu"</span>, <span class="st">"x_sigma_sigma"</span>,
             <span class="st">"y_sigma_mu"</span>, <span class="st">"y_sigma_sigma"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For digging deeper into the model, other packages from the Stan development team will be useful. For example, if you have <code>RStan</code> installed, you can use the function <code>rstan::read_stan_csv</code> to reformat the results and use <a href="https://mc-stan.org/shinystan/"><code>shinystan</code></a>.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stanfit</span> <span class="op">&lt;-</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu">read_stan_csv</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">output_files</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shinystan</span><span class="fu">::</span><span class="fu">launch_shinystan</span><span class="op">(</span><span class="va">stanfit</span><span class="op">)</span></code></pre></div>
<p>When applying this model to your data, it is a good idea to browse through these plots. For now, focus on the three main parameters of interest, the average noise at low and high contrast (<code>x_sigma_mu</code> and <code>y_sigma_mu</code>), and the average slope (<code>g_mu</code>). For ease of plotting, convert them into a <code>tibble</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">draws</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g_mu"</span>, <span class="st">"x_sigma_mu"</span>,<span class="st">"y_sigma_mu"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p>Now use <code>tidyverse</code> packages to plot the posteriors. For example, we can look at whether there is evidence that the noise differs across levels of contrast.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">draws</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">g_mu</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"sigma"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Contrast"</span>, values_to <span class="op">=</span> <span class="st">"Noise"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    Contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
      <span class="va">Contrast</span>, 
      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x_sigma_mu"</span>, <span class="st">"y_sigma_mu"</span><span class="op">)</span>,
      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Noise</span>, fill<span class="op">=</span><span class="va">Contrast</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">50</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>Finally, what is the average slope?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">draws</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"sigma"</span><span class="op">)</span>, Slope <span class="op">=</span> <span class="st">"g_mu"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Slope</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Since multiplicative gain but not additive offset predict a slope larger than 1, these data provide more evidence that contrast causes multiplicative neuromodulation.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>If hierarchical modeling is unfamiliar, see <a href="https://mc-stan.org/rstanarm/articles/pooling.html">here</a> for a brief introduction.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The terminology <a href="https://en.wikipedia.org/wiki/Deming_regression">“Deming”</a> refers to this later relaxation.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This model is also available on the <code>nmmr</code> repository, <a href="https://github.com/psadil/nmmr/blob/main/inst/stan/deming.stan">here</a>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Increasing the “adapt delta” parameter will likely cause the model to run more slowly, but also avoid divergences. With only 100 voxels, there is not quite enough data to wrangle the posterior with the default sampler settings. When working with a larger dataset (e.g., 1000+ voxels), the default sampling parameters (i.e., <code>adapt_delta = 0.8</code>) may be sufficient.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Alternatively, you can use <code>shinystan</code> without installing <code>RStan</code> by instead installing the development version of <code>shinystan</code>. See <a href="https://github.com/stan-dev/shinystan/issues/184" class="uri">https://github.com/stan-dev/shinystan/issues/184</a>.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Sadil.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
